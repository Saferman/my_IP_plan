小白也能搞定CPU（六）datapath数据通路搭建

## 正文
小白听到搭建CPU电路是不是感到恐惧，不用怕！今天分享一个我带学生在实验室熬夜肝出来的「CPU addi指令数据通路」详细流程，跟着我只需要 4 步思路，就能在 Logisim-Evolution 里搭建出实现任何指令的CPU完整电路图！

🌟 为什么从 addi 命令开始？

- 只有 I-type，字段少，不易翻车
- 不需要处理 rs2、条件分支Branch、内存模块Mem，连线最简单
- 一旦跑通，后面很多命令只需要在此基础上实现

🔧 果子老师总结的4 步思考模板（背下来直接套）
1️⃣ 指令长啥？

比如addi命令结构是

31:20 = imm[11:0]
19:15 = rs1
14:12 = funct3（addi=000）
11:7  = rd
6:0   = opcode = 0010011

2️⃣ ALU 模块怎么输入和输出（之前系列教程讲解过）？
A ← 寄存器堆 ReadData1
B ← 立即数生成器输出
ALUSel = 0000（硬编码加法）

3️⃣ 指令是否涉及访问内存？
addi 不需要内存数据，暂时不用 DMEM，这一步可以跳过

4️⃣ 指令处理的结果是否需要保存？
ALUResult → 寄存器堆 WriteData
RegWEn = 1（常高，一定写回）

🛠️ Logisim 实操要点

- Splitter ：1 根 32-bit 线进去，5 根字段线出来，拆分指令
- 立即数生成器：我之前系列讲解过，直接使用
- 寄存器堆：记得把 Clock 接上去，不然无法仿真！
- 接线顺序：Instruction → Splitter → RegFile/ImmGen → ALU → RegFile，形成闭环

⚠️ 避坑提醒
× 忘记接 Clock → 寄存器不更新
× Splitter 位宽填错 → 字段全乱
× ALU 端口接反 → 结果全 0

适合课程：

CS61C、CS152、CMPS101、EECS16A、EECS16B、COMPSCI61A、EECS6、COMP1511、CS101。

\#CPU设计 #Logisim #计算机组成原理 